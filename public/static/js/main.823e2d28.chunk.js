(this["webpackJsonpimdb-frontend"]=this["webpackJsonpimdb-frontend"]||[]).push([[0],{100:function(e,t,a){e.exports=a(207)},105:function(e,t,a){},106:function(e,t,a){},207:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(88),l=a.n(c),o=(a(105),a(3)),i=(a(106),a(10)),s=a(9);var m=function(e){var t=e.movie,a=void 0===t?{}:t;return r.a.createElement("div",{className:"col-sm-3",style:{minWidth:"20rem"}},r.a.createElement("div",{className:"card text-white bg-primary mb-3"},r.a.createElement("div",{className:"card-header"},a.name," | Popularity: ",a["99popularity"]),r.a.createElement("div",{className:"card-body"},r.a.createElement("h4",{className:"card-title"},a.imdb_score),a.genre?a.genre.map((function(e){return r.a.createElement("span",{key:e,className:"badge badge-secondary"},e)})):"",r.a.createElement("p",{className:"card-text"},a.director),e.isEditable?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.b,{to:{pathname:"/movie/edit/".concat(a._id)}},r.a.createElement("button",{type:"button",className:"btn btn-secondary"},"Edit")),r.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:function(t){return e.deleteMovie(a._id)}},"Delete")):null)))},u=a(18),d=a.n(u),p=a(23),b=Object(p.a)(d.a.mark((function e(){var t=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch.apply(void 0,t).then((function(e){return e}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),E=function(e){var t=Object.keys(e).map((function(t){return"".concat(t,"=").concat(e[t])})).join("&");return b("/api/movie?"+t)},g=function(e){return b("/api/movie",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)})},f=r.a.createContext({});var v=function(e){e.movie;var t=Object(n.useState)(""),a=Object(o.a)(t,2),c=a[0],l=a[1],i=function(t){return e.onSubmit(c)};return r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"SearchBar"},"Search"),r.a.createElement("input",{type:"text",className:"form-control",id:"SearchBar",placeholder:"Search a movie...",onChange:function(e){return l(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),i())}}))),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:i},"Search"))},h=a(4);var y=function(){var e=Object(n.useContext)(f),t=Object(n.useState)(0),a=Object(o.a)(t,2),c=a[0],l=a[1],s=Object(n.useState)([]),u=Object(o.a)(s,2),d=u[0],p=u[1],g=Object(n.useState)(1),y=Object(o.a)(g,2),N=y[0],j=(y[1],Object(n.useState)(0)),w=Object(o.a)(j,2),O=(w[0],w[1]),x=Object(n.useState)("99popularity"),S=Object(o.a)(x,2),k=S[0],C=S[1],F=Object(n.useState)([]),P=Object(o.a)(F,2),M=P[0],I=P[1],T=Object(n.useState)(1),D=Object(o.a)(T,2),A=D[0],B=D[1],L=Object(n.useState)(""),q=Object(o.a)(L,2),H=q[0],U=q[1],_=(Object(h.g)(),window.location.href.includes("admin")),J={"99popularity":"Popularity",director:"Director Name",name:"Movie Name"};Object(n.useEffect)((function(){console.log("useEffect"),G({searchVal:H,limit:25,skip:25*(N-1),sortBy:k,reverse:A,genre:M})}),[c,H,N,25,k,A,M]);var G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};E(e).then((function(e){return e.json()})).then((function(e){p(e.data),O(e.totalCount||0)})).catch((function(e){return alert("There was an error processing your request")}))},W=function(e){window.confirm("Are you sure you wish to delete this movie? THIS CANNOT BE UNDONE")&&function(e){return b("/api/movie",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e})})}({id:e}).then((function(e){return e.json()})).then((function(e){alert(e.msg),l(c+1)})).catch((function(e){return alert("Sorry, couldn't delete the movie. Please try again later")}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(v,{onSubmit:U}),r.a.createElement("div",null,e.genres.map((function(e){var t=M.find((function(t){return t===e})),a="badge badge-pill ".concat(t?"badge-primary":"badge-secondary"," mr-2");return r.a.createElement("span",{className:a,onClick:function(t){return function(e){var t=Object(i.a)(M),a=t.findIndex((function(t){return t===e}));a>-1?t.splice(a,1):t.push(e),I(t)}(e)}},e)}))),r.a.createElement("div",{class:"btn-group",role:"group","aria-label":"Button group with nested dropdown"},r.a.createElement("button",{type:"button",class:"btn btn-primary"},"Sort By: ",J[k]),r.a.createElement("div",{class:"btn-group",role:"group"},r.a.createElement("button",{id:"btnGroupDrop1",type:"button",class:"btn btn-primary dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}),r.a.createElement("div",{class:"dropdown-menu","aria-labelledby":"btnGroupDrop1"},Object.keys(J).map((function(e){return r.a.createElement("a",{class:"dropdown-item",onClick:function(t){return C(e)}},J[e])}))))),r.a.createElement("div",{class:"btn-group",role:"group","aria-label":"Button group with nested dropdown"},r.a.createElement("button",{type:"button",class:"btn btn-primary"},"99popularity"===k?1===A?"Low to High":"High to Low":1===A?"Alphabetical":"Reverse"),r.a.createElement("div",{class:"btn-group",role:"group"},r.a.createElement("button",{id:"btnGroupDrop1",type:"button",class:"btn btn-primary dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}),r.a.createElement("div",{class:"dropdown-menu","aria-labelledby":"btnGroupDrop1"},"99popularity"===k?r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{class:"dropdown-item",onClick:function(e){return B(-1)}},"High to Low"),r.a.createElement("a",{class:"dropdown-item",onClick:function(e){return B(1)}},"Low to High")):r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{class:"dropdown-item",onClick:function(e){return B(1)}},"Alphabetical"),r.a.createElement("a",{class:"dropdown-item",onClick:function(e){return B(-1)}},"Reverse"))))),r.a.createElement("hr",null),r.a.createElement("div",{class:"container"},r.a.createElement("div",{class:"row"},d.length?d.map((function(e){return r.a.createElement(m,{key:Math.random(),movie:e,isEditable:_,deleteMovie:W})})):"No Movies to display!")))},N=a(56),j=a(12),w=a(14);function O(){var e=Object(n.useContext)(f).loggedInUser;return r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-primary"},r.a.createElement("a",{className:"navbar-brand",href:"#"},"Navbar"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarColor01","aria-controls":"navbarColor01","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarColor01"},r.a.createElement("ul",{className:"navbar-nav mr-auto"},r.a.createElement(s.b,{to:"/"},r.a.createElement("li",{className:"nav-item active"},r.a.createElement("a",{className:"nav-link",href:"#"},"Home ",r.a.createElement("span",{className:"sr-only"},"(current)")))),e&&e.name?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.b,{to:"/login"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link",href:"#"},"Update Movies"))),r.a.createElement(s.b,{to:"/movie/create"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link",href:"#"},"Add Movie")))):r.a.createElement(s.b,{to:"/login"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link",href:"#"},"Login")))))))}var x=w.c({name:w.e().required("Name is required"),director:w.e().required("Director Name is required"),imdb_score:w.b().required("Score is required").min(0,"Score should be positive").max(10,"Score should not be more than 10"),"99popularity":w.b().required("Popularity is required").min(0,"Popularity should be positive").max(100,"Popularity should not be more than 100"),genre:w.e()}),S=function(){var e=Object(h.h)().id;Object(n.useEffect)((function(){(function(e){return b("/api/movie/single?movieId="+e)})(e).then((function(e){return e.json()})).then((function(e){return l(e.data)})).catch((function(e){return alert("There was an error! Please try again later.")}))}),[e]);var t=Object(n.useState)({name:"",director:"",imdb_score:0,"99popularity":0,genre:""}),a=Object(o.a)(t,2),c=a[0],l=a[1],i=Object(h.g)(),s=function(){var t=Object(p.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return t.next=3,a=Object(N.a)(Object(N.a)({},c),{},{modelId:e}),b("/api/movie",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)});case 3:t.next=7;break;case 5:return t.next=7,g(c);case 7:i.push("/admin");case 8:case"end":return t.stop()}var a}),t)})));return function(){return t.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"jumbotron"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"}),r.a.createElement("div",{className:"card-body"},r.a.createElement(j.a,{className:"w-100",schema:x,value:c,onSubmit:function(e){return s()},onChange:function(e){return l(e)}},r.a.createElement("fieldset",{className:"w-100"},r.a.createElement("legend",{className:"text-center"},"".concat(e?"Edit ":"Add "," Movie")),r.a.createElement(j.a.Field,{className:"form-control mt-3 w-100",name:"name",placeholder:"Movie name",disabled:!!e}),r.a.createElement(j.a.Message,{className:"pl-1 text-danger",for:"name"}),r.a.createElement(j.a.Field,{className:"form-control mt-3 w-100",name:"director",placeholder:"Director Name"}),r.a.createElement(j.a.Message,{className:"pl-1 text-danger",for:"director"}),r.a.createElement(j.a.Field,{className:"form-control mt-3 w-100",name:"imdb_score",placeholder:"IMDB Score"}),r.a.createElement(j.a.Message,{className:"pl-1 text-danger",for:"imdb_score"}),r.a.createElement(j.a.Field,{className:"form-control mt-3 w-100",name:"99popularity",placeholder:"Popularity"}),r.a.createElement(j.a.Message,{className:"pl-1 text-danger",for:"99popularity"}),r.a.createElement(j.a.Field,{className:"form-control mt-3 w-100",name:"genre",placeholder:"Genre (Comma Seperated)"}),r.a.createElement(j.a.Message,{className:"pl-1 text-danger",for:"genre"}),r.a.createElement(j.a.Submit,{className:"btn btn-primary mt-3 w-100",type:"button"},"Submit")))))))};function k(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(""),i=Object(o.a)(l,2),s=i[0],m=i[1],u=Object(n.useState)(!1),d=Object(o.a)(u,2),p=d[0],E=(d[1],Object(n.useContext)(f)),g=function(e){return function(t){var a=t.target.value;switch(e){case"email":c(a);break;case"password":m(a)}}};return r.a.createElement(r.a.Fragment,null,E.loggedInUser&&E.loggedInUser.name?r.a.createElement(h.a,{to:"/admin"}):r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("legend",null,"Login"),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"exampleInputEmail1"},"Email address"),r.a.createElement("input",{type:"email",className:"form-control",id:"exampleInputEmail1","aria-describedby":"emailHelp",placeholder:"Enter email",onChange:g("email")}),r.a.createElement("small",{id:"emailHelp",className:"form-text text-muted"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"exampleInputPassword1"},"Password"),r.a.createElement("input",{type:p?"text":"password",className:"form-control",id:"exampleInputPassword1",placeholder:"Password",onChange:g("password")}),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){var t,n;(n={email:a,password:s},b("/api/auth/login",{method:"POST",body:JSON.stringify(n),headers:{Accept:"application/json","Content-Type":"application/json"}})).then((function(e){return t=e.status,e.json()})).then((function(e){200!==t?e.msg?alert(e.msg):console.error(e):E.onLogin(e.user)})).catch((function(e){return console.error(e)}))}},"Login")))))}function C(e){var t=e.children,a=Object(n.useContext)(f);return r.a.createElement(r.a.Fragment,null,a.loggedInUser.name?t:r.a.createElement(h.a,{to:"/login"}))}function F(){return r.a.createElement("div",null,r.a.createElement(h.d,null,r.a.createElement(h.b,{path:"/",exact:!0},r.a.createElement(y,null)),r.a.createElement(h.b,{path:"/login",exact:!0},r.a.createElement(k,null)),r.a.createElement(C,null,r.a.createElement(h.b,{path:"/admin",exact:!0},r.a.createElement(y,null)),r.a.createElement(h.b,{path:"/movie/create",exact:!0},r.a.createElement(S,null)),r.a.createElement(h.b,{path:"/movie/edit/:id",exact:!0},r.a.createElement(S,null)))))}var P=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)({}),i=Object(o.a)(l,2),m={genres:a,loggedInUser:i[0],onLogin:i[1]};return Object(n.useEffect)((function(){b("/api/movie/genres").then((function(e){return e.json()})).then((function(e){return c(e.data.genres)})).catch((function(e){console.error(e),alert("Sorry, we were unable to fetch the genre list")}))}),[]),r.a.createElement("div",{className:"App"},r.a.createElement(s.a,null,r.a.createElement(f.Provider,{value:m},r.a.createElement(O,null),r.a.createElement(F,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[100,1,2]]]);
//# sourceMappingURL=main.823e2d28.chunk.js.map